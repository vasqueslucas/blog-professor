---
title: "Mapa de Paradas de Ônibus – Linha 2506"
---

## Introdução

Neste post eu mostro como utilizei a API **Olho Vivo SPTrans** para buscar as paradas da linha **2506** e gerar um **mapa interativo** usando *Folium*.  
O código lê o token do arquivo `.env`, autentica na API e depois plota cada parada no mapa.

Abaixo está o código completo utilizado, formatado da mesma forma que no blog do meu amigo.

---

## Código utilizado

```python
# onibus_map.py

from folium import Map, Marker
import os
import requests
from dotenv import load_dotenv

# Carrega o token do arquivo .env
load_dotenv(".env")

s = requests.Session()

# Autenticação na API da SPTrans
res = s.post(
    f"http://api.olhovivo.sptrans.com.br/v2.1/Login/Autenticar?token={os.getenv('SPTRANS_TOKEN')}"
)
print(res.text)

# Busca as paradas da linha 2506
res = s.get(
    "http://api.olhovivo.sptrans.com.br/v2.1/Parada/BuscarParadasPorLinha?codigoLinha=2506"
)
paradas = res.json()

# Visualizamos as três primeiras paradas
paradas[:3]

# Criação do mapa, centralizado em uma das paradas
m = Map(location=[paradas[3]["py"], paradas[3]["px"]], zoom_start=14)

# Adiciona cada parada como um marcador no mapa
for i in paradas:
    Marker(
        location=[i["py"], i["px"]],
        popup=i["np"]
    ).add_to(m)

# Abre o mapa no navegador
m.show_in_browser()
```

---

## Resultado

O resultado final é um mapa interativo mostrando **todas as paradas da linha 2506**, com cada ponto clicável exibindo o nome da parada.  
Essa abordagem pode ser usada para qualquer linha da SPTrans, bastando trocar o código da linha.
## Resultado

A figura abaixo mostra todas as paradas da linha 2506 plotadas no mapa, usando Folium.

![Mapa das paradas da linha 2506](map.png)

---

## Observações

- Certifique-se de ter o arquivo `.env` dentro da pasta **onibus**, contendo seu token desta forma:  
  ```
  SPTRANS_TOKEN=seu_token_aqui
  ```
- Instale as bibliotecas necessárias:  
  ```
  pip install folium python-dotenv requests
  ```

---
